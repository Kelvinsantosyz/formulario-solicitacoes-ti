function enviarEmailResposta(e) {
    if (!e || !e.values) {
        Logger.log("Erro: Evento 'e' nÃ£o foi passado corretamente.");
        return;
    }

    var resposta = e.values;
    var emailDestino = ""; // E-mail do suporte de TI

    // Ajuste dos Ã­ndices conforme a sua planilha
    var dataHora = resposta[0];  
    var titulo = resposta[1];  
    var nome1 = resposta[2];  // Primeira ocorrÃªncia de "Nome completo"
    var nome2 = resposta[3];  // Segunda ocorrÃªncia de "Nome completo"
    var tipoSolicitacao = resposta[4];  
    var localidade = resposta[5];  
    var anyDesk = resposta[6];  // Disponibilize AnyDesk
    var descricao = resposta[7];  // DescriÃ§Ã£o do problema
    var emailUsuario = resposta[8]; // EndereÃ§o de e-mail do usuÃ¡rio

    // DefiniÃ§Ã£o do nome (caso uma das colunas esteja vazia)
    var nome = nome1 ? nome1 : nome2;

    // Criando o assunto e mensagem do e-mail
    var assunto = "Nova SolicitaÃ§Ã£o de TI - " + (titulo ? titulo : "Sem TÃ­tulo");
    var mensagem = "ðŸ“Œ *Nova SolicitaÃ§Ã£o de TI Recebida*\n\n";
    mensagem += "ðŸ“… *Data:* " + dataHora + "\n";
    mensagem += "ðŸ‘¤ *Nome:* " + (nome ? nome : "NÃ£o informado") + "\n";
    mensagem += "ðŸ“ *Tipo de SolicitaÃ§Ã£o:* " + (tipoSolicitacao ? tipoSolicitacao : "NÃ£o informado") + "\n";
    mensagem += "ðŸ“ *Localidade:* " + (localidade ? localidade : "NÃ£o informado") + "\n";
    mensagem += "ðŸ–¥ï¸ *AnyDesk:* " + (anyDesk ? anyDesk : "NÃ£o informado") + "\n";  
    mensagem += "ðŸ’¬ *DescriÃ§Ã£o:* " + (descricao ? descricao : "NÃ£o informado") + "\n";
    mensagem += "âœ‰ï¸ *E-mail do UsuÃ¡rio:* " + (emailUsuario ? emailUsuario : "NÃ£o informado") + "\n";

    // Enviar e-mail apenas para o suporte de TI
    MailApp.sendEmail(emailDestino, assunto, mensagem);
}

function ativarGatilho() {
    var triggers = ScriptApp.getProjectTriggers();

    // Remover gatilhos antigos para evitar duplicaÃ§Ã£o
    triggers.forEach(trigger => {
        if (trigger.getHandlerFunction() === "enviarEmailResposta") {
            ScriptApp.deleteTrigger(trigger);
        }
    });

    // Criar um novo gatilho para submissÃ£o do formulÃ¡rio
    ScriptApp.newTrigger("enviarEmailResposta")
        .forSpreadsheet(SpreadsheetApp.getActiveSpreadsheet())
        .onFormSubmit()
        .create();

    Logger.log("ðŸ”” Gatilho ativado com sucesso!");
}
